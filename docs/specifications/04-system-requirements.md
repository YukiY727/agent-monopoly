# システム要件

## 機能要件

### ゲームプレイ

- **FR-001**: 2-8人の同時プレイをサポート
- **FR-002**: モノポリー公式ルールを完全実装
- **FR-003**: リアルタイム通信による同期プレイ
- **FR-004**: プレイヤーのアクションを即座に全員に反映
- **FR-005**: ゲーム途中での切断・再接続をサポート

### AI対戦

- **FR-006**: 強化学習エージェントをプレイヤーとして参加可能
- **FR-007**: 人間プレイヤーとAIプレイヤーの混在をサポート
- **FR-008**: 複数の学習済みモデルから選択可能

### データ記録

- **FR-009**: 全プレイヤーのアクションを記録
- **FR-010**: ゲーム状態の完全な履歴を保持
- **FR-011**: 任意の時点の状態を再現可能
- **FR-012**: イベント単位での詳細な記録

### 分析機能

- **FR-013**: 行動経済学分析の4項目を実装
- **FR-014**: ゲーム理論分析の4項目を実装
- **FR-015**: 時系列分析の5項目を実装
- **FR-016**: 強化学習用データの5項目を実装
- **FR-017**: 各分析結果をグラフで可視化
- **FR-018**: データをCSV/JSON形式でエクスポート
- **FR-019**: OpenAI Gym形式でエクスポート
- **FR-020**: TensorFlow形式でエクスポート

### 管理者機能

- **FR-021**: 過去のゲーム一覧表示
- **FR-022**: 個別ゲームの詳細分析
- **FR-023**: 複数ゲームの比較分析
- **FR-024**: プレイヤー別の統計表示

## 非機能要件

### パフォーマンス

- **NFR-001**: 同時に10-20ゲームの実行をサポート
- **NFR-002**: アクション実行から全クライアントへの反映まで1秒以内
- **NFR-003**: 分析画面の初期表示は3秒以内
- **NFR-004**: 時系列グラフの描画は2秒以内

### 可用性

- **NFR-005**: システム稼働率99%以上
- **NFR-006**: プレイヤー切断時も他プレイヤーのゲーム継続可能
- **NFR-007**: サーバー再起動時もゲーム状態を復元可能

### 拡張性

- **NFR-008**: 新しい分析機能の追加が容易
- **NFR-009**: ルール変更への対応が容易
- **NFR-010**: 新しいAIモデルの追加が容易

### 保守性

- **NFR-011**: コードの可読性を重視
- **NFR-012**: ドメインロジックとインフラの明確な分離
- **NFR-013**: 単体テストカバレッジ80%以上
- **NFR-014**: 統合テストの自動化

### データ完全性

- **NFR-015**: 全イベントの順序保証
- **NFR-016**: イベントの欠落を防止
- **NFR-017**: データの整合性検証機能
- **NFR-018**: バックアップとリカバリ機能

## データ保存要件

### イベント保存

- **DR-001**: 全アクションをイベントとして記録
- **DR-002**: イベントには一意のID、タイムスタンプ、順序番号を付与
- **DR-003**: イベントは不変（削除・更新不可）
- **DR-004**: イベントから任意時点の状態を再構築可能

### イベントの種類

以下のイベントを記録:

- ゲーム開始/終了
- ターン開始/終了
- サイコロ振り
- プレイヤー移動
- 物件購入/拒否
- オークション開始/入札/落札
- 家賃支払い
- 建物建設/売却
- 抵当設定/解除
- 取引提案/応答/成立
- カード取得/使用
- 破産
- その他全ての状態変更

### 保存データ

各イベントに以下を含む:

- イベントID（UUID）
- ゲームID
- プレイヤーID
- イベントタイプ
- イベントデータ（JSON）
- タイムスタンプ
- 順序番号

### データ保持期間

- **DR-005**: 全ゲームデータを無期限保存
- **DR-006**: 定期的なバックアップ実施
