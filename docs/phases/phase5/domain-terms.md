# Phase 5 ドメイン用語集

**Phase 5**: 複数ゲーム実行機能の実装

---

## 1. シミュレーション関連用語

### 1.1 Simulation（シミュレーション）

**定義**: 複数のゲームを連続実行し、統計的な結果を得る行為

**Phase 5での実装範囲**:
- N回のゲーム実行
- 結果の記録と集計

**Phase 6以降での拡張**:
- 統計分析
- ファイル保存
- グラフ表示

### 1.2 Multiple Game Run（複数ゲーム実行）

**定義**: 同じ条件で複数のゲームを連続実行すること

**特徴**:
- 各ゲームは完全に独立
- 同じ初期設定（プレイヤー、戦略、ボード）を使用
- ランダム要素（サイコロ）のみが異なる

### 1.3 Single Game Run（単一ゲーム実行）

**定義**: 1回のゲームのみを実行すること（Phase 4までの動作）

**対比**: Multiple Game Run

---

## 2. 結果関連用語

### 2.1 SingleGameResult（単一ゲーム結果）

**定義**: 1回のゲーム実行の結果データ

**含まれる情報**:
```kotlin
data class SingleGameResult(
    val gameNumber: Int,        // ゲーム番号
    val winner: String,          // 勝者名
    val totalTurns: Int,        // 総ターン数
    val finalState: GameState,  // 最終状態
)
```

### 2.2 MultiGameResult（複数ゲーム結果）

**定義**: 複数ゲーム実行の集計結果

**含まれる情報**:
- 各ゲームの結果リスト（`List<SingleGameResult>`）
- 総ゲーム数
- 勝率、平均ターン数などの集計データ

### 2.3 Game Number（ゲーム番号）

**定義**: 複数実行時の各ゲームの連番（1から開始）

**例**:
- 100ゲーム実行時: 1, 2, 3, ..., 100

---

## 3. 統計用語

### 3.1 Win Rate（勝率）

**定義**: 特定プレイヤーが勝利したゲーム数 ÷ 総ゲーム数

**計算式**:
```
勝率 = プレイヤーの勝利数 / 総ゲーム数 × 100 (%)
```

**例**:
- 100ゲーム中、Aliceが60勝 → Aliceの勝率 = 60%

### 3.2 Average Turns（平均ターン数）

**定義**: 全ゲームのターン数の平均値

**計算式**:
```
平均ターン数 = Σ(各ゲームのターン数) / 総ゲーム数
```

**例**:
- ゲーム1: 50ターン
- ゲーム2: 60ターン
- ゲーム3: 40ターン
- 平均: (50 + 60 + 40) / 3 = 50ターン

### 3.3 Min/Max Turns（最短/最長ターン数）

**定義**: 全ゲーム中の最短および最長のゲームのターン数

**用途**: ゲームの長さのばらつきを把握

---

## 4. 進捗表示関連用語

### 4.1 Progress Display（進捗表示）

**定義**: 複数ゲーム実行中の進行状況をターミナルに表示する機能

**表示内容**:
- 現在のゲーム番号
- 進捗率（%）
- プログレスバー

**例**:
```
Progress: [====================] 100/100 (100%)
```

### 4.2 Progress Bar（プログレスバー）

**定義**: 視覚的に進捗を示す棒グラフ

**実装**:
```
[========================================] (100%)
[====================                    ] (50%)
[==========                              ] (25%)
```

### 4.3 Elapsed Time（経過時間）

**定義**: シミュレーション開始から終了までの時間

**単位**: 秒（小数点以下2桁）

**例**: `Completed 100 games in 12.34 seconds`

---

## 5. 設定関連用語

### 5.1 Number of Games（ゲーム数）

**定義**: 実行するゲームの回数

**CLI引数**: `--games N`

**デフォルト**: 1（単一ゲーム実行）

**例**:
- `--games 100`: 100ゲーム実行
- `--games 1`: 1ゲーム実行（Phase 4までと同じ動作）

### 5.2 Game Config（ゲーム設定）

**定義**: ゲーム実行に必要な設定情報

**含まれる情報**:
```kotlin
data class GameConfig(
    val strategy: BuyStrategy,      // 使用する戦略
    val numberOfGames: Int,         // 実行回数
    val generateReport: Boolean,    // レポート生成フラグ
)
```

### 5.3 Player Strategies（プレイヤー戦略）

**定義**: 各プレイヤーに割り当てる戦略のリスト

**形式**: `List<Pair<String, BuyStrategy>>`

**例**:
```kotlin
listOf(
    "Alice" to AlwaysBuyStrategy(),
    "Bob" to ConservativeStrategy(),
)
```

---

## 6. CLI オプション用語

### 6.1 --games オプション

**定義**: 実行するゲーム数を指定

**使用法**: `--games <N>`

**制約**: N は正の整数

**例**:
- `--games 10`: 10ゲーム実行
- `--games 1000`: 1000ゲーム実行

### 6.2 --no-report オプション

**定義**: HTMLレポート生成を抑制

**使用法**: `--no-report`

**動作**:
- 複数ゲーム実行時、HTMLレポートを一切生成しない
- 結果サマリーのみターミナルに表示

**用途**: 大量のゲーム実行時にファイル生成を避ける

---

## 7. クラス・コンポーネント用語

### 7.1 GameRunner

**定義**: 複数ゲーム実行を管理するクラス

**責務**:
- N回のゲーム実行のオーケストレーション
- 各ゲームの初期化
- 結果の収集
- 進捗表示の制御

**パッケージ**: `com.monopoly.simulation`

### 7.2 ProgressDisplay

**定義**: 進捗表示を担当するクラス

**責務**:
- プログレスバーの描画
- 進捗率の計算
- 経過時間の測定

**パッケージ**: `com.monopoly.cli`

### 7.3 ResultSummaryPrinter

**定義**: 実行結果サマリーを表示するクラス

**責務**:
- 勝者サマリーの表示
- ターン統計の表示
- フォーマットされた出力

**パッケージ**: `com.monopoly.cli`

---

## 8. 実装パターン用語

### 8.1 Independent Game Execution（独立ゲーム実行）

**定義**: 各ゲームが互いに影響を与えずに実行されること

**実装**:
- 各ゲームで新しい `GameState` を作成
- プレイヤーや戦略も新規インスタンス化
- 前のゲームの状態は次のゲームに持ち越さない

### 8.2 Sequential Execution（逐次実行）

**定義**: ゲームを1つずつ順番に実行すること

**対比**: Parallel Execution（並列実行、Phase 8で実装）

**Phase 5の方針**: 逐次実行のみ

### 8.3 Result Aggregation（結果集計）

**定義**: 各ゲームの結果を集めて統計情報を計算すること

**Phase 5での範囲**:
- 勝率
- 平均ターン数
- 最短/最長ターン数

**Phase 6以降での拡張**:
- より詳細な統計項目
- ファイル保存
- グラフ生成

---

## 9. パフォーマンス用語

### 9.1 Throughput（スループット）

**定義**: 単位時間あたりに実行できるゲーム数

**単位**: ゲーム/秒

**Phase 5の目標**: 10ゲーム/秒以上（100ゲームを10秒以内）

### 9.2 Memory Footprint（メモリ使用量）

**定義**: シミュレーション実行時のメモリ消費量

**Phase 5の課題**: 全ゲームの `finalState` を保持するため、大量実行時にメモリを消費

**Phase 6での改善**: 必要な統計情報のみ抽出し、GameStateは破棄

---

## 10. レポート関連用語

### 10.1 Detailed Report（詳細レポート）

**定義**: Phase 2で実装した、イベントタイムラインを含む詳細レポート

**ファイル名**: `game-report-*.html`

**Phase 5での扱い**: 複数ゲーム実行時は生成しない

### 10.2 Summary Report（サマリーレポート）

**定義**: Phase 4で実装した、結果に特化したレポート

**ファイル名**: `game-summary-*.html`

**Phase 5での扱い**: オプションで最後のゲームのみ生成

### 10.3 Result Summary（結果サマリー）

**定義**: ターミナルに表示される複数ゲーム実行の集計結果

**Phase 5で新規追加**

**表示内容**:
```
SIMULATION RESULTS
==================
Winner Summary:
  Alice  : 60 wins (60.0%)
  Bob    : 40 wins (40.0%)

Turn Statistics:
  Average turns: 52.3
  Min turns:     35
  Max turns:     78
```

---

## 11. 対比表

| 用語 | Phase 4まで | Phase 5 |
|------|-----------|---------|
| 実行モード | Single Game Run | Single + Multiple Game Run |
| 結果データ | GameState のみ | SingleGameResult + MultiGameResult |
| 進捗表示 | なし | ProgressDisplay |
| 結果表示 | HTMLレポート | HTMLレポート + ターミナルサマリー |
| パッケージ | domain, cli | domain, cli, simulation |
| CLI引数 | --strategy | --strategy, --games, --no-report |

---

## 12. 将来の拡張用語（参考）

Phase 6以降で追加予定：

- **Statistics（統計）**: より詳細な統計分析
- **Data Export（データエクスポート）**: JSON/CSV形式での保存
- **Parallel Execution（並列実行）**: マルチスレッド実行（Phase 8）
- **Visualization（可視化）**: グラフ表示（Phase 7）

---

**作成日**: 2025-11-16
